var DATALAYER=(function($){function _log(error){if((typeof window.console!=="undefined"&&typeof window.console.log!=="undefined")&&console.debug){console.debug(error)}return false}function _formatString(string){if(typeof string==="string"){return string.toLowerCase().replace(/ |_/g,"-").replace("&ntilde;","n").replace(/&amp;|&/g,"and").replace(/-{2,}/g,"-").replace(/\//g,":").replace(/:{2,}/g,":").replace(/[:-]+$/g,"").replace(":en:",":us:").replace(/[^a-z0-9:\-\|]/gi,"")}}function _getBreakpoint(){var width=(window.innerWidth>0)?window.innerWidth:screen.width;if(width>=960){return"desktop"}else{if(width>=768){return"tablet"}else{if(width>=568){return"phablet"}else{return"mobile"}}}}function _getVehicleContextVars(context){var vars={},vehicle="";if(context.year){vars.eVar48=context.year;vars.prop48=context.year}if(context.vehicle){vehicle=context.vehicle;if(context.trim){vehicle+=context.trim}vehicle=_formatString(vehicle);vars.eVar5=vehicle;vars.prop1=vehicle}return vars}function _extendObject(oldObj,newObj){for(var i in newObj){oldObj[i]=newObj[i]}}function _getCookie(cookieName){var cookieVal="";if(typeof cllc!=="undefined"&&typeof cllc.context.get(cookieName)!=="undefined"){cookieVal=cllc.context.get(cookieName)}else{var re=new RegExp(cookieName+"=([^;]+)");var value=re.exec(document.cookie);cookieVal=(value!==null)?(value[1]):""}return cookieVal}function _detectDevice(){var device;if(screen.width<800&&location.hostname.split(".")[0].indexOf("m")>-1){device="mobile"}else{device="desktop"}return device}function _getMediaEvent(type){var sKey=_satellite.getVar("serial_key");if(type=="vehicle"){return sKey+_satellite.getVar("vehicleMediaCode")}else{return sKey+_satellite.getVar("brandMediaCode")}}function _getLinkTrackingObject(element){var trackObj={vars:{},mediaEvents:[],},linkContext={},lid="",lpos="",linkType="o",elmEvars=null,elmProps=null,events="",brandEvent="",vehicleEvent="";if(element.getAttribute){if(element.getAttribute("data-context")){linkContext=JSON.parse(element.getAttribute("data-context"));_extendObject(trackObj.vars,_getVehicleContextVars(linkContext))}if(element.getAttribute("data-lid")){lid=element.getAttribute("data-lid");lpos=element.getAttribute("data-lpos")||"content";trackObj.lid=lid;trackObj.lpos=lpos;trackObj.vars={eVar68:"click"}}if(element.getAttribute("data-adobe-linktype")){linkType=element.getAttribute("data-adobe-linktype")}if(element.getAttribute("data-adobe-events")){events+=element.getAttribute("data-adobe-events")}if(events.indexOf("event70")==-1){if(events.length){events+=","}events+="event70"}if(element.getAttribute("data-brand-event")&&_getMediaEvent("brand")){brandEvent=element.getAttribute("data-brand-event");trackObj.mediaEvents.push({name:brandEvent,value:_getMediaEvent("brand")})}if(element.getAttribute("data-vehicle-event")&&_getMediaEvent("vehicle")){vehicleEvent=element.getAttribute("data-vehicle-event");trackObj.mediaEvents.push({name:vehicleEvent,value:_getMediaEvent("vehicle")})}trackObj.events=events;if(element.getAttribute("data-adobe-evars")){elmEvars=element.getAttribute("data-adobe-evars")}if(element.getAttribute("data-adobe-props")){elmProps=element.getAttribute("data-adobe-props")}if(element.getAttribute("data-adobe-linkname")){trackObj.linkName=element.getAttribute("data-adobe-linkname")}if(linkType=="d"||(!linkType&&/download/i.test(element.innerHTML))){if(!(/download_brochure/i.test(lid))){linkType="d";trackObj.linkName=trackObj.linkName||element.getAttribute("download")||element.getAttribute("href");if(!/wallpaper/i.test(trackObj.linkName)){var brochureBrand=brand;if(brand=="ramtrucks"){brochureBrand="ram"}else{if(brand=="fiatusa"){brochureBrand="fiat"}else{if(brand=="alfaromeousa"){brochureBrand="alfa-romeo"}}}if((lid).indexOf(brochureBrand)!=-1){var brochureModel=_formatString(lid.split(brochureBrand+"_")[1].split("download")[0].replace(/accessories/g,"").replace(/catalog/g,""));var brochureModelYear=_formatString((lid).split(brochureBrand)[0]);trackObj.lpos="brochure";_extendObject(trackObj.vars,{eVar5:brochureModel,prop1:brochureModel,eVar48:brochureModelYear,prop48:brochureModelYear})}}}}else{if(element.getAttribute("href")&&element.getAttribute("href").indexOf("exit")>-1){linkType="exit"}}trackObj.linkType=linkType}if(elmEvars!==null){elmEvars=JSON.parse(elmEvars);_extendObject(trackObj.vars,elmEvars)}if(elmProps!==null){elmProps=JSON.parse(elmProps);_extendObject(trackObj.vars,elmProps)}return trackObj}var location=document.location;var hostName=location.hostname;var url=location.href,hash=location.hash,pathName=location.pathname,environment=hostName.split(".")[0].toLowerCase(),language=(hostName.indexOf("es.")>=0||hostName.indexOf("es-")>=0)?"es":"en",brand=(window.cllc?cllc.config.brand:context.brand),brandID="",version="interwoven 7.3",country="us";var _pageInfo=new Array({environment:environment,cmsVersion:version,device:"",language:language,brand:brand,brandID:brandID,country:country,pageType:"",model:"",pageName:"",vehicle:"",trim:"",year:"",component:{}});function _setPageInfo(){var _context={};if(typeof cllc!=="undefined"&&cllc.context.get()){_context=cllc.context.get()}else{_context=context}for(var info in _pageInfo[0]){if(_context[info]!==undefined||_context[info]===""){_pageInfo[0][info]=_formatString(_context[info])}}if(_pageInfo[0].brand==="fiatusa"){_pageInfo[0].brand="fiat"}if(_pageInfo[0].pageType==="app"){_pageInfo[0].pageType="shopping-tools"}if(_pageInfo[0].pageType==="vehiclepage"){_pageInfo[0].pageType="vehicles"}try{if(_context.vehicle){_pageInfo[0]["vehicleFamilyCode"]=Vehicles.getFamilyCode({vehicle:_context.vehicle})}}catch(e){console.log(e)}return _pageInfo[0]}function _getValue(property){if(typeof property==="string"){return _pageInfo[0][property]}else{if(!arguments.length){return _pageInfo[0]}else{_log(typeof property+" not allowed!")}}}function _updateDigitalData(name,value,callback){var strSplit=(name).split("."),strJn="",newObj={},spl=strSplit.length;for(var i=0;i<spl;i++){if(i==0){strJn+=strSplit[i]}else{if(i<spl-1){if((eval("("+strJn+")")).hasOwnProperty(strSplit[i])){strJn+="."+strSplit[i]}else{newObj=eval("("+strJn+")");newObj[strSplit[i]]={};strJn+="."+strSplit[i]}}else{newObj=(eval("("+strJn+")"))[strSplit[i]]=value}}}if(callback&&typeof callback==="function"){callback()}}function _setValue(object,callback){if(typeof object==="object"){for(var property in object){if(typeof _pageInfo[0][property]=="object"){_extendObject(_pageInfo[0][property],object[property])}else{_pageInfo[0][property]=object[property]}}_setDigitalDataVariable(_pageInfo[0]);if(callback&&typeof callback==="function"){callback()}}else{_log("Please use object to set new app/pageType/pageName e.g. {'key':'value', and so on...}")}}function _setDigitalDataVariable(data){function _ifDrlp(){if(typeof cllc!=="undefined"&&cllc.context.get()){if(typeof cllc.config.domain!=="undefined"&&(cllc.config.domain.indexOf("currentoffers")>-1||cllc.config.domain==="buyfiat")){return true}}}function _getRegion(){if(_ifDrlp()){return"tier2"}else{return"tier1"}}function _getPageSize(){return"long"}function _getPrimaryCategory(){var pCat;pCat=(data.pageType?":"+data.pageType:"");if(_ifDrlp()){pCat=":drlp"+pCat}return pCat}function _getPageName(){var pName;if(data.pageType==="shopping-tools"){pName=":"+data.pageType+":"+data.pageName}else{if(data.pageType==="vehicles"){if(!!data.vehicle&&data.pageName!=="se-models"){pName=":"+data.year+":"+data.vehicle+":"+data.pageName;if(!!data.trim&&data.trim.length>0){pName=":"+data.year+":"+data.vehicle+":"+data.trim+":"+data.pageName}}else{pName=":"+data.pageType+":"+data.pageName}}else{if(data.pageType==="homepage"){pName=":"+data.pageType}else{if(data.pageName!==""){pName=":"+(data.pageType?data.pageType+":"+data.pageName:data.pageName)}else{pName=":"+data.pageType}}}}if(_ifDrlp()){pName=":drlp"+pName}return pName}function _subCategoryData1(){var subCatData1;if(data.pageType==="shopping-tools"){subCatData1=":"+data.pageType+":"+data.pageName.split(":")[0]}else{if(data.pageType==="vehicles"&&data.pageName==="se-models"){subCatData1=":"+data.pageType+":"+data.pageName}else{if(data.pageType==="vehicles"&&data.trim===""&&data.pageName!=="vehicle-selector"){subCatData1=":"+data.pageType+":"+data.vehicle}else{if(data.pageType==="vehicles"&&data.trim.length>0&&(data.pageName===""||data.pageName==="landing")){subCatData1=":"+data.pageType+":"+data.vehicle}else{if(data.pageType==="vehicles"&&data.trim.length>0){subCatData1=":"+data.pageType+":"+data.vehicle+":"+data.trim}else{if(data.pageType==="lifestyle"&&data.pageName.split(":")[0]==="renegade-life"){subCatData1=":"+data.pageType+":renegade-life"}else{if(data.pageName!==""){subCatData1=":"+(data.pageType?data.pageType+":"+data.pageName:data.pageName)}else{subCatData1=":"+data.pageType}}}}}}}if(_ifDrlp()){subCatData1=":drlp"+subCatData1}return subCatData1}function _subCategoryData2(){var subCatData2;if(data.pageType==="shopping-tools"){subCatData2=":"+data.pageType+":"+data.pageName}else{if(data.pageType==="vehicles"){if(data.pageName==="se-models"){subCatData2=":"+data.pageType+":"+data.pageName}else{if(data.trim===""&&data.pageName!=="vehicle-selector"){subCatData2=":"+data.pageType+":"+data.vehicle}else{if(data.trim.length>0){if((data.pageName===""||data.pageName==="landing")){subCatData2=":"+data.pageType+":"+data.vehicle+":"+data.trim}else{subCatData2=":"+data.pageType+":"+data.vehicle+":"+data.trim+":"+data.pageName}}else{if(data.pageName!==""){subCatData2=":"+(data.pageType?data.pageType+":"+data.pageName:data.pageName)}}}}}else{if(data.pageName!==""){subCatData2=":"+(data.pageType?data.pageType+":"+data.pageName:data.pageName)}else{subCatData2=":"+data.pageType}}}if(_ifDrlp()){subCatData2=":drlp"+subCatData2}return subCatData2}function _getPageType(){var pType;if(data.pageName==="vehicle-selector"){pType=data.pageName}else{if(data.pageType==="shopping-tools"){if(data.pageName.indexOf(":vehicle-selector")>-1){pType=data.pageName.split(":")[1]}else{if(data.pageName.indexOf(":vehicle-selector")===-1){pType=data.pageName.split(":")[0]}}}else{if(data.pageType==="vehicles"){if(data.pageName=="landing"){if(data.trim!==""&&data.vehicle!==""){pType="mlp"}else{if(data.trim===""&&data.vehicle!==""){pType="vlp"}}}else{pType=data.pageName.split(":")[0]}}else{pType=data.pageType}}}return pType}function _getErrorCode(){var eCode;if(data.pageType==="error-page"){eCode=404}if(typeof eCode!=="undefined"){return"page:"+eCode}else{return""}}var brand=(_detectDevice()=="mobile")?"m-"+data.brand:data.brand;window.digitalData={page:{pageInfo:{pageName:brand+":"+data.country+_getPageName(),geoRegion:"brand:"+brand+":"+data.country+":"+_getRegion(),device:data.device,language:data.language,responsiveState:_getBreakpoint(),version:data.cmsVersion,sysEnv:_detectDevice(),size:_getPageSize(),vehicleBrand:brand,vehicleModel:_formatString(data.vehicle),vehicleMediaCode:data.vehicleFamilyCode,vehicleTrim:_formatString(data.trim),vehicleDetailedTrim:_formatString(data.model),vehicleModelYear:_formatString(data.year),zipCode:_getCookie("zipcode"),errorCode:_getErrorCode()},category:{primaryCategory:brand+":"+data.country+_getPrimaryCategory(),subCategory1:brand+":"+data.country+_subCategoryData1(),subCategory2:brand+":"+data.country+_subCategoryData2(),pageType:_getPageType()},component:data.component}}}function _buildTTString(str){var ttUrl="https://"+location.hostname+"/?";var ttParams=_satellite.getVar("totalTagParams");totaltag(ttUrl+ttParams)}function _pageTrack(argument){var arg=argument||"";if(window._satellite&&window.s){s.clearVars("events");s.clearVars("eVars");s.clearVars("props");if(typeof arg==="string"&&arg!==""){_satellite.track(arg)}else{s.t(arg)}}}function _linkTrack(element,obj){function getInteractionName(linktype,lpos,lid){var interactionVars=[],info=digitalData.page.pageInfo;interactionVars.push(info.vehicleBrand);interactionVars.push(linktype);var interactionPage=s.pageName.split(":");if(interactionPage.length==3){interactionVars.push(interactionPage[2])}else{interactionVars.push(interactionPage.slice(interactionPage.length-2,interactionPage.length).join(":"))}interactionVars.push(lpos);interactionVars.push(lid);return interactionVars.join("|").toLowerCase()}if(!element||!element.getAttribute||element.tagName!="A"){element=true}var linkType=null;if(window.s){var linkTrackVarsArray=[],events=obj.events||"event70",responsiveState=_getBreakpoint(),eVars=obj.vars||{},concatValue=obj.linkName||_formatString(obj.lpos+":"+obj.lid);events+=(events.indexOf("event70")==-1)?",event70":"";linkType=obj.linkType||"o";if(linkType&&linkType=="cta"||linkType=="promo"||linkType=="nav"||linkType=="func"||linkType=="social"||linkType=="exit"){eVars.eVar75=getInteractionName(linkType,obj.lpos,obj.lid);concatValue=eVars.eVar75}if(linkType=="exit"||linkType=="social"){linkType="e"}if(!window.cllc||!cllc.context.get()||_detectDevice=="mobile"){eVars.prop42=_satellite.getVar("orientation")}eVars.prop53=responsiveState;eVars.eVar53=responsiveState;if(!eVars.eVar75){eVars.eVar75=_formatString(obj.lpos+":"+obj.lid)}s.linkTrackEvents="None";s.linkTrackVars="None";linkTrackVarsArray.push("events","eVar37","prop57","prop51","eVar66");var trackEvents=events;if(obj.mediaEvents&&obj.mediaEvents.length){for(var i=0;i<obj.mediaEvents.length;i++){var eventName=obj.mediaEvents[i].name;var serializedValue=eventName+":"+obj.mediaEvents[i].value;trackEvents+=","+eventName;events+=","+serializedValue}}s.linkTrackEvents=trackEvents;s.events=events;if(!eVars.hasOwnProperty("eVar68")){eVars.eVar68="click"}for(var key in eVars){linkTrackVarsArray.push(key);s.linkTrackVars=linkTrackVarsArray.join(",");s[key]=_formatString(eVars[key])}s.tl(element,linkType,concatValue);if(obj.pageTrack&&typeof obj.pageTrack==="string"){_pageTrack(obj.pageTrack)}if(obj.mediaEvents&&obj.mediaEvents.length){var ttUrl="https://"+location.hostname+"/?";var ttParams=_satellite.getVar("totalTagParams");ttParams=ttParams.replace(/prop25=[^&]+&/i,"prop25="+obj.lid+"&");totaltag(ttUrl+ttParams)}}}function _initEvents(){if(!!cllc.context.get()){cllc.context.addListener("pageName",function(oldPage,newPage){if(newPage!=undefined&&newPage&&(newPage!=oldPage)){_setDigitalDataVariable(_setPageInfo())}});cllc.context.addListener("pageType",function(oldPage,newPage){if(newPage!=undefined&&newPage&&(newPage!=oldPage)){_setDigitalDataVariable(_setPageInfo())}});cllc.context.addListener("year",function(oldVal,newVal){if(newVal!=undefined&&newVal&&(newVal!=oldVal)){_setDigitalDataVariable(_setPageInfo())}});cllc.context.addListener("vehicle",function(oldVal,newVal){if(newVal!=undefined&&newVal&&(newVal!=oldVal)){_setDigitalDataVariable(_setPageInfo())}});cllc.context.addListener("trim",function(oldVal,newVal){if(newVal!=undefined&&newVal&&(newVal!=oldVal)){_setDigitalDataVariable(_setPageInfo())}})}}function _initClickTracks(){jQuery(document).on("click","a",function(e){var element=this;if(element.getAttribute&&(element.getAttribute("data-donottrack")||element.getAttribute("data-stoptrack")||!element.getAttribute("data-lid"))){return true}var trackObject=_getLinkTrackingObject(this);DATALAYER.linkTrack(this,trackObject)})}function _setMarketCode(){var market_codes=cllc.request.queryString.toJSON();var cookie=new cllc.httpCookie("market_code");var expireDate=new Date().getTime();var expireTime=86400000*45;cookie.values=market_codes;cookie.expires=new Date(expireDate+=expireTime);cllc.request.cookies.add(cookie)}function _init(){_log("Adobe analytics initialized, use DATALAYER to set/get pageTrack info or linkTrack");_setDigitalDataVariable(_setPageInfo())}if(window.cllc){_initEvents();_init()}_initClickTracks();return{init:_init,get:_getValue,set:_setValue,updateDigitalData:_updateDigitalData,formatString:_formatString,linkTrack:_linkTrack,pageTrack:_pageTrack,buildTTString:_buildTTString,getMediaEvent:_getMediaEvent}}(jQuery));